---
title: 中古PCでMisskeyインスタンスを建てる際の備考
description: 
published: true
date: 2024-05-01T04:47:25.387Z
tags: operation, server
editor: markdown
dateCreated: 2023-04-07T23:08:27.227Z
---

> **注意**
> この記事は2023年4月以前に作成された投稿をサルベージしたものです。

# 中古PCでMisskeyインスタンスを建てる際の備考

　 VPSやホスティングサービスだと、結構維持費がかかるのと、破壊的な変更を気軽に出来ないことから、自宅に転がっている中古PCを使用してMisskeyインスタンスを運営できないか模索する。

　
## 必要とされるPCスペック

　一人で運営するインスタンスでない限り、ある程度快適に動作することは当然のことながら、外部と頻繁に通信する性質を持っている以上、急な負荷に耐えられる性能が求められる。

CPUはIntelの第三世代core-i3(2コア4スレッド程度)で十分であるが、メモリに関しては最低でも10GB以上積んでおくと良いだろう。

　価格面で魅力的なのがraspberry piであるが、これの場合製品によってはSDカードを記憶装置としている場合があり、頻繁に情報を書き込むMisskeyでは長期運用は難しいように思える。適宜SSDないしHDDを導入する必要がある。尚、複数で構成して保険を掛けるという手法も考えられるが、こうなると予算が中古PCを上回る。

　ストレージの容量に関してはアクティブユーザーが10人未満の場合であれば128GBあれば半年間は存続できるが、昨今の相場を考えると大は小を兼ねる発想を取るほうが賢明に思える。

## OSをどうするか

Fedora,WindowsServer,Ubuntu(Debian)で数か月検証してみたが、WSLに関してはお勧めできない。管理パネルで一括して管理できるメリットよりも、サブシステムとして動いている環境をWindowsと結び付けて公開するまでの作業が非常に煩瑣であった。尚WSLを使ったとしても設定を正確に行えば正常に動作する。

## DDNSか静的IPか

自宅に構築した環境を世界に開く作業を行うわけだが、ここでDDNSを取るか静的IPを契約する手段を取るかが迫られる。どちらかと言われると静的IPのほうが良いに決まってるのだが、契約費用の面を考えると悩ましい。しかし、DDNSの手段をもって運用したところ、他のサーバーの投稿取得が最長5時間程度遅延して行われることが判明したため、大規模に運営する場合は思い切って契約するのが良いように思える。 数百人程度の場合はCloudflareのTunnel機能を使うのが最善に思える。多少本体に負荷はかかるものの、DDNSやポート開放などの面倒な設定を要せずに外部に公開できるうえに、遅延も無い。更に無償で利用できる点も強い。

## 負荷

　VPSと比較するとメモリに負荷がかかりにくい点が特徴のように見える。概ね常時稼働のユーザーが10人いればメモリ1％増加する程度のようだ。しかしVPSとは異なり、気軽に増設工事が出来ない点からも、余力を持って拡張していく必要性はある。